<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Panel del Owner - Hor G Cargo Express</title>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(to right, #4CAF50, #B266FF);
  color: #222;
  text-align: center;
  padding: 20px;
}
h2 {
  color: white;
  text-shadow: 1px 1px 3px #333;
}
input, button {
  padding: 10px;
  margin: 5px;
  border-radius: 8px;
  border: none;
  font-size: 16px;
}
button {
  background: #4CAF50;
  color: white;
  cursor: pointer;
}
button:hover {
  background: #45a049;
}
table {
  width: 90%;
  margin: 20px auto;
  border-collapse: collapse;
  background: white;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
}
th {
  background: #B266FF;
  color: white;
  padding: 10px;
}
td {
  padding: 8px;
  text-align: center;
  border-bottom: 1px solid #ddd;
}
</style>
</head>
<body>

<h2>Resumen del Owner (conectado a Google Sheets)</h2>

<div>
  <label>Mes:</label>
  <input type="text" id="mes" placeholder="Ej: Octubre">
  <label>Semana:</label>
  <input type="text" id="semana" placeholder="Ej: 1">
  <label>Driver:</label>
  <input type="text" id="driver" placeholder="Ej: Driver 1">
  <button onclick="filtrarDatos()">Filtrar</button>
  <button onclick="limpiar()">Limpiar</button>
</div>

<table id="tabla"></table>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQJNoOMFPAB8M-UhmKHG1rWxJvHaumF1k012pKyTkUSq2XC5blEQXkNxvAcyfKvayVPjoLjhUGMRA8p/pub?gid=1933431995&single=true&output=csv";
let datos = [];
let columnasResumen = ["fecha", "origen", "destino", "carga", "ingreso", "gasto", "neto"]; // üëà pon aqu√≠ las columnas que tiene tu hoja RESUMEN_APP

// 1Ô∏è‚É£ Cargar datos de la hoja "Viajes"
Papa.parse(CSV_URL, {
  download: true,
  header: true,
  complete: function(results) {
    datos = results.data.map(row => {
      const limpio = {};
      for (const key in row) {
        const k = key.trim().toLowerCase();
        limpio[k] = (row[key] || "").toString().trim().toLowerCase();
      }
      return limpio;
    });
    // No mostramos nada al inicio
    document.getElementById("tabla").innerHTML = "<tr><td colspan='7'>Ingrese filtros y pulse BUSCAR</td></tr>";
  }
});

// 2Ô∏è‚É£ Mostrar solo columnas que est√°n en la hoja Resumen_App
function renderTable(rows) {
  const tabla = document.getElementById("tabla");
  if (!rows.length) {
    tabla.innerHTML = "<tr><td colspan='7'>No hay resultados para los filtros seleccionados</td></tr>";
    return;
  }

  tabla.innerHTML = "<tr>" + columnasResumen.map(h => `<th>${h.toUpperCase()}</th>`).join("") + "</tr>";
  rows.forEach(r => {
    tabla.innerHTML += "<tr>" + columnasResumen.map(h => `<td>${r[h] ?? ""}</td>`).join("") + "</tr>";
  });
}

// 3Ô∏è‚É£ Filtro de b√∫squeda (mes, semana, chofer)
function filtrarDatos() {
  const mes = document.getElementById("mes").value.trim().toLowerCase();
  const semana = document.getElementById("semana").value.trim().toLowerCase();
  const chofer = document.getElementById("driver").value.trim().toLowerCase();

  const filtrado = datos.filter(r => {
    const m = (r["mes"] || "").trim().toLowerCase();
    const s = (r["semana"] || "").trim().toLowerCase();
    const c = (r["chofer"] || "").trim().toLowerCase();
    return (!mes || m === mes) && (!semana || s === semana) && (!chofer || c === chofer);
  });

  renderTable(filtrado);
}

// 4Ô∏è‚É£ Limpiar b√∫squeda
function limpiar() {
  document.getElementById("mes").value = "";
  document.getElementById("semana").value = "";
  document.getElementById("driver").value = "";
  document.getElementById("tabla").innerHTML = "<tr><td colspan='7'>Ingrese filtros y pulse BUSCAR</td></tr>";
}
</script>




</body>
</html>

